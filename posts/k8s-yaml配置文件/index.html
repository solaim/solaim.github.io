<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>K8s Yamlé…ç½®æ–‡ä»¶ | Jerry Wang</title>
<meta name=keywords content><meta name=description content="1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml
å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š
# application/guestbook/redis-master-deployment.yaml 
apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
kind: Deployment
metadata:
  name: redis-master
  labels:
    app: redis
spec:
  selector:
    matchLabels:
      app: redis
      role: master
      tier: backend
  replicas: 1
  template:
    metadata:
      labels:
        app: redis
        role: master
        tier: backend
    spec:
      containers:
      - name: master
        image: redis  # or just image: redis
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
        ports:
        - containerPort: 6379
é€šè¿‡æ‰§è¡Œå‘½ä»¤kubectl create -f redis-master-deployment.yamlï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ"><meta name=author content="Jerry Wang"><link rel=canonical href=https://solaim.github.io/posts/k8s-yaml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/><link crossorigin=anonymous href=/assets/css/stylesheet.f49d66caae9ea0fd43f21f29e71a8d3e284517ed770f2aa86fa012953ad3c9ef.css integrity="sha256-9J1myq6eoP1D8h8p5xqNPihFF+13Dyqob6ASlTrTye8=" rel="preload stylesheet" as=style><link rel=icon href=https://solaim.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://solaim.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://solaim.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://solaim.github.io/apple-touch-icon.png><link rel=mask-icon href=https://solaim.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://solaim.github.io/posts/k8s-yaml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://solaim.github.io/posts/k8s-yaml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"><meta property="og:site_name" content="Jerry Wang"><meta property="og:title" content="K8s Yamlé…ç½®æ–‡ä»¶"><meta property="og:description" content="1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š
# application/guestbook/redis-master-deployment.yaml apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2 kind: Deployment metadata: name: redis-master labels: app: redis spec: selector: matchLabels: app: redis role: master tier: backend replicas: 1 template: metadata: labels: app: redis role: master tier: backend spec: containers: - name: master image: redis # or just image: redis resources: requests: cpu: 100m memory: 100Mi ports: - containerPort: 6379 é€šè¿‡æ‰§è¡Œå‘½ä»¤kubectl create -f redis-master-deployment.yamlï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ"><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-11-18T21:23:35+08:00"><meta property="article:modified_time" content="2019-11-18T21:23:35+08:00"><meta property="og:image" content="https://solaim.github.io/img/favicon.webp"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://solaim.github.io/img/favicon.webp"><meta name=twitter:title content="K8s Yamlé…ç½®æ–‡ä»¶"><meta name=twitter:description content="1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml
å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š
# application/guestbook/redis-master-deployment.yaml 
apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
kind: Deployment
metadata:
  name: redis-master
  labels:
    app: redis
spec:
  selector:
    matchLabels:
      app: redis
      role: master
      tier: backend
  replicas: 1
  template:
    metadata:
      labels:
        app: redis
        role: master
        tier: backend
    spec:
      containers:
      - name: master
        image: redis  # or just image: redis
        resources:
          requests:
            cpu: 100m
            memory: 100Mi
        ports:
        - containerPort: 6379
é€šè¿‡æ‰§è¡Œå‘½ä»¤kubectl create -f redis-master-deployment.yamlï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://solaim.github.io/posts/"},{"@type":"ListItem","position":2,"name":"K8s Yamlé…ç½®æ–‡ä»¶","item":"https://solaim.github.io/posts/k8s-yaml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"K8s Yamlé…ç½®æ–‡ä»¶","name":"K8s Yamlé…ç½®æ–‡ä»¶","description":"1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š\n# application/guestbook/redis-master-deployment.yaml apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2 kind: Deployment metadata: name: redis-master labels: app: redis spec: selector: matchLabels: app: redis role: master tier: backend replicas: 1 template: metadata: labels: app: redis role: master tier: backend spec: containers: - name: master image: redis # or just image: redis resources: requests: cpu: 100m memory: 100Mi ports: - containerPort: 6379 é€šè¿‡æ‰§è¡Œå‘½ä»¤kubectl create -f redis-master-deployment.yamlï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ\n","keywords":[],"articleBody":"1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š\n# application/guestbook/redis-master-deployment.yaml apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2 kind: Deployment metadata: name: redis-master labels: app: redis spec: selector: matchLabels: app: redis role: master tier: backend replicas: 1 template: metadata: labels: app: redis role: master tier: backend spec: containers: - name: master image: redis # or just image: redis resources: requests: cpu: 100m memory: 100Mi ports: - containerPort: 6379 é€šè¿‡æ‰§è¡Œå‘½ä»¤kubectl create -f redis-master-deployment.yamlï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ\nå¾ˆç®€å•ï¼Œåªéœ€è¦å°†yamlæ–‡ä»¶ä¸­çš„spec.replicasè®¾ç½®ä¸º3å³å¯ï¼Œé‚£ä¹ˆä¸€ä¸ªyamlæ–‡ä»¶å¯ä»¥æ§åˆ¶ä»€ä¹ˆå‘¢ï¼Ÿ\næˆ‘ä»¬é€šè¿‡å››ä¸ªæ¨¡å—ç®€å•çš„ä»‹ç»ä¸€ä¸‹k8sä½¿ç”¨çš„yamlé…ç½®æ–‡ä»¶ï¼Œå½“ç„¶äº†ä¹Ÿå¯ä»¥ä½¿ç”¨jsonæ ¼å¼ï¼Œæ¯•ç«Ÿkubectlæ˜¯æŠŠyamlæ–‡ä»¶è½¬æ¢æˆjsonæ–‡ä»¶ä¹‹åå†å‘é€ç»™kube-apiServerçš„ã€‚\n2ã€apiVersionæ¨¡å— ä¸ºå•¥è¦åœ¨è¿™å¼•å…¥ä¸€ä¸ªapiVersionï¼ŸapiVersionè·Ÿè½¯ä»¶ç‰ˆæœ¬æœ‰æ²¡æœ‰å…³ç³»ï¼Ÿâ€¦\nä¸€ä¸ªç®€å•çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿå¼•å‡ºå¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯å›ç­”é—®é¢˜ï¼Œéœ€è¦ä¸€ä¸ªä¸€ä¸ªæ¥ã€‚\né¦–å…ˆï¼Œk8sæ˜¯master-nodeæ¶æ„æ¨¡å¼ï¼Œmasterä¸Šä¸€èˆ¬ä¸è¿è¡Œkubeletï¼ˆè¦æ˜¯æœºå™¨ç‰›é€¼ä¹Ÿå¯ä»¥çš„å“ˆï¼‰ï¼Œåªè´Ÿè´£èµ„æºçš„ç®¡ç†å’Œè°ƒåº¦ç­‰ç­‰å·¥ä½œã€‚æˆ‘ä»¬ä½¿ç”¨kubectlçš„æ—¶å€™ï¼Œå®é™…æ˜¯åœ¨è·ŸmasterèŠ‚ç‚¹ä¸Šçš„kube-apiServerè¿›è¡Œé€šä¿¡ï¼Œæ‰€æœ‰çš„è¯·æ±‚æäº¤åˆ°kube-apiServerï¼Œè€Œkubectlè·Ÿkube-apiServerçš„é€šä¿¡å®é™…ä¸Šæ˜¯ä¸€æ¬¡httpè¯·æ±‚ï¼Œæˆ‘ä»¬ä½¿ç”¨curlå‘½ä»¤å¯ä»¥è¿›è¡Œç®€å•çš„æµ‹è¯•å°±å¯ä»¥è¯å®è¿™ä¸€ç‚¹ã€‚\nå…¶æ¬¡ï¼Œk8sæ•´ä½“ç‰ˆæœ¬å·²ç»å‡çº§åˆ°1.16ï¼Œç‰ˆæœ¬å‡çº§å¸¦æ¥å¯ä»¥æ“æ§èµ„æºçš„å˜åŠ¨ï¼Œå¼€å‘è€…æœŸå¾…å¢åŠ æ–°çš„èµ„æºï¼Œä»¥é¢å¯¹ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼Œä½†æ˜¯å·²ç»å­˜åœ¨çš„å®¢æˆ·ç«¯æ€ä¹ˆåŠäº†ï¼Œæ­¦æ–­çš„ç›´æ¥å‡çº§ï¼Œä¼šç ´åå…¼å®¹æ€§ï¼Œæ‰€ä»¥ï¼Œå¼•å…¥apiVersionå¯ä»¥ä¿è¯å…¼å®¹æ€§ã€‚\næ‰€ä»¥ä½¿ç”¨apiVersionæ—¢å¯ä»¥ä¿è¯å…¼å®¹æ€§ï¼Œåˆå¯ä»¥å…¼é¡¾å®ç°å±‚é¢çš„é—®é¢˜ã€‚Soï¼Œnext oneï¼\napiVersionè·Ÿè½¯ä»¶çš„Versionæ˜¯æ²¡æœ‰ç›´æ¥å…³ç³»çš„ï¼ŒapiVersionå¯èƒ½å­˜åœ¨å¥½å‡ ä¸ªç‰ˆæœ¬ä¸­ã€‚ä¸åŒçº§åˆ«çš„apiVersionï¼Œæ„å‘³ç€ä¸åŒçš„ç¨³å®šæ€§å’Œæ”¯æŒåº¦ã€‚apiVersionçš„çº§åˆ«å¦‚ä¸‹ï¼š\nåºå· ç‰ˆæœ¬ å¤‡æ³¨ 1 alpha åç§°ä¸­åŒ…å«alphaï¼Œå¯èƒ½å­˜åœ¨bugï¼Œç‰ˆæœ¬ç‰¹æ€§å¯èƒ½è¢«ä¸¢å¼ƒï¼Œåç»­ç‰ˆæœ¬å¯èƒ½ä¸å…¼å®¹ï¼Œæµ‹è¯•ç¯å¢ƒä½¿ç”¨ 2 beta åç§°ä¸­åŒ…å«betaï¼Œä»£ç ç»è¿‡æµ‹è¯•ï¼Œç‰ˆæœ¬ç‰¹æ€§ä¸ä¼šä¸¢å¼ƒï¼Œå®ç°å±‚é¢å¯èƒ½å˜åŠ¨ï¼Œéå•†ä¸šç¯å¢ƒä½¿ç”¨ 3 stable åç§°ä¸­åŒ…å«vXï¼ŒXæ˜¯ä¸€ä¸ªæ•´æ•° ä¸ºäº†æ‰©å±•k8s apiæ–¹ä¾¿ï¼Œå¼€å‘äººå‘˜å®ç°äº†API groupsã€‚API groupsåœ¨restè·¯å¾„ä¸­æŒ‡å®šï¼Œè€Œåœ¨apiVersionä¸­æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ã€‚ç›®å‰ä½¿ç”¨çš„API groupsåŒ…å«ï¼š\n1ã€æ ¸å¿ƒç»„ï¼šrestè·¯å¾„æ˜¯/api/v1ï¼ŒapiVersionä¸­æ˜¯v1\n2ã€å‘½åç»„ï¼šrestè·¯å¾„æ˜¯/apis/$GROUP_NAME/$VERSION,apiVersionä¸­æ˜¯$GROUP_NAME/$VERSION\næœ‰è€é“å¯èƒ½å‘ç°äº†ï¼Œä½ è¿™ç¤ºä¾‹ç»™çš„apps/v1,appsæ˜¯å•¥äº†ï¼Ÿappså°±æ˜¯ä¸€ä¸ªå‘½åç»„çš„åç§°ï¼Œè¡¨ç¤ºåŠŸèƒ½å’Œk8sè¿è¡Œçš„åº”ç”¨æœ‰å…³è”ï¼Œæ¯”å¦‚è¯´Deployments, RollingUpdates, and ReplicaSetsã€‚å½“ç„¶åŒä¸€ä¸ªè·¯å¾„ä¸‹å¯èƒ½åŒ…å«å¤šç§ç±»å‹çš„èµ„æºï¼Œæ‰€ä»¥k8sä¸ºäº†åŒºåˆ«å…·ä½“çš„åŒºåˆ«ï¼Œä½¿ç”¨äº†kindæ ‡è¯†å…·ä½“çš„èµ„æºç±»å‹ã€‚\n3ã€kindæ¨¡å— kindå­—æ®µç”¨äºæ ‡è¯†èµ„æºç±»å‹ï¼Œé‚£ä¹ˆk8sæ”¯æŒçš„èµ„æºç±»å‹æœ‰å“ªäº›äº†ï¼Ÿ\nå¤ªå¤šäº†ï¼Œä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚æå‡ ä¸ªå¸¸ç”¨çš„ï¼Œæ¯”å¦‚Deploymentã€ReplicaControllerã€Podå’ŒServiceç­‰ç­‰ã€‚ç°åœ¨æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³ç»™å¥¹ä¸€ä¸ªåå­—ï¼Œæ€ä¹ˆåŠï¼Ÿ\n4ã€metadataæ¨¡å— æ˜¾ç¤ºï¼Œmetadataæ¨¡å—å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„è¿™ä¸ªéœ€æ±‚ï¼Œmetadata.nameå°±æ˜¯æè¿°æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„å¯¹è±¡çš„åç§°ï¼Œå½“ç„¶k8sè¿˜æœ‰å…¶ä»–çš„metadataéœ€è¦æè¿°ï¼Œæ¯”å¦‚metadata.namespaceï¼Œé»˜è®¤ä¸ºdefaultï¼Œmetadata.uidä¸éœ€è¦æ‰‹åŠ¨å¡«å†™ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆã€‚è¿™å‡ ä¸ªè¦ä¹ˆå¿…é¡»å¡«å†™ï¼Œè¦ä¹ˆç³»ç»Ÿç”Ÿæˆï¼Œæ˜¯å¿…å¤‡ç¡¬è´§ã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç»„ç»‡èµ„æºï¼Œmetadataæä¾›labelså­—æ®µï¼Œå¯ä»¥ç»„ç»‡å’Œåˆ†ç±»å¯¹è±¡ã€‚labelæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œlabelså¯ä»¥åŒæ—¶åˆå¤šä¸ªlabelï¼Œé€—å·åˆ†éš”ã€‚è¿˜æœ‰å…¶ä»–å­—æ®µï¼Œå°±ä¸ç»†è¯´äº†ã€‚\nå¥½ï¼Œä¸Šé¢ä¸‰ä¸ªæ¨¡å—åŸºæœ¬æè¿°äº†æˆ‘è¦åˆ›å»ºä¸€ä¸ªä»€ä¹ˆæ ·çš„å¯¹è±¡ï¼Œé‚£å…·ä½“å’‹å®ç°äº†ï¼Ÿå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ—¶é—´ç‚¹ï¼Œå½“å‰æ—¶é—´å’Œæœ€ç»ˆæ—¶é—´ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å—å»æè¿°æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ï¼Œè¿™å°±æ˜¯specæ¨¡å—çš„æ´»ã€‚\n5ã€specæ¨¡å— é¢ï¼Œè¿™ä¸ªæ¨¡å—å°±æ˜¯å¹²è„æ´»ã€ç´¯æ´»çš„ã€‚\nåˆ›å»ºçš„å¯¹è±¡ç‰›ä¸ç‰›é€¼ï¼Œå°±çœ‹åœ¨è¿™å’‹å†™äº†ã€‚\næ—¢ç„¶specæ˜¯å†™æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æè¿°ï¼šæˆ‘æƒ³è¦3ä¸ªé»„è‰²çš„ã€æ ‡å‡†å¤§å°çš„çº¢åŒå–œä¹’ä¹“çƒã€‚è¿™é‡Œä¹’ä¹“çƒæˆ‘ä»¬è¦çº¢åŒå–œçš„ï¼Œæ•°é‡æ˜¯ä¸‰ä¸ªï¼Œæ€§è´¨æ˜¯é»„è‰²çš„ã€æ ‡å‡†å¤§å°çš„ã€‚æ‰€ä»¥spec.selectorå°±æ˜¯é€‰æ‹©å“ªä¸ªç‰Œå­çš„ä¹’ä¹“çƒï¼Œspec.replicasæ˜¯ä¹’ä¹“çƒçš„æ•°é‡ï¼Œspec.templateåˆ™æè¿°ä¹’ä¹“çƒçš„å…·ä½“å±æ€§ä¿¡æ¯ã€‚çœ‹æ¥templateè¿˜æ˜¯å®ç°æœ€ç»ˆçŠ¶æ€çš„å…³é”®ï¼Œæ¨¡æ¿templateå°±æ˜¯ç”¨æ¥åˆ¶ä½œçº¢åŒå–œé»„è‰²ã€æ ‡å‡†å¤§å°ä¹’ä¹“çƒçš„ã€‚æ¯ä¸ªè¢«åˆ¶é€ çš„ä¹’ä¹“çƒéƒ½å…·æœ‰ç›¸åŒçš„å…ƒä¿¡æ¯ã€åˆ¶ä½œè¿‡ç¨‹å’ŒåŠŸèƒ½ï¼Œk8sç”¨spec.template.metadataæè¿°å…ƒä¿¡æ¯ï¼Œspec.template.specæè¿°åˆ¶ä½œè¿‡ç¨‹ã€‚åœ¨k8sçš„åº•å±‚ä½¿ç”¨çš„æ˜¯å®¹å™¨æŠ€æœ¯ï¼Œæ‰€ä»¥spec.template.specå®é™…æè¿°æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¦‚æœkindæ˜¯Serviceï¼Œæ˜¯æ²¡æœ‰spec.template.specå­—æ®µçš„ã€‚å½“ç„¶ï¼Œspecä¸‹é¢è¿˜æœ‰å…¶ä»–å­—æ®µï¼Œéœ€è¦æ ¹æ®apiVersionå’Œkindè¿›è¡Œé€‚é…ï¼Œè¿™é‡Œå°±ä¸ç»†è¯´äº†ã€‚\næ‰€ä»¥ï¼Œyamlæ–‡ä»¶æè¿°äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªèµ„æºå¯¹è±¡ã€‚apiVersionæŒ‡å®šäº†åˆ›å»ºèµ„æºå¯¹è±¡ä½¿ç”¨çš„k8s APIç‰ˆæœ¬ï¼ŒkindæŒ‡å®šäº†ç±»å‹ï¼Œmetadataå”¯ä¸€çš„æè¿°äº†èµ„æºå¯¹è±¡ï¼Œspecæè¿°äº†æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ã€‚\nå—¯ï¼Œçœ‹å®Œè¿™ä¸ªï¼Œæ˜¯å¯ä»¥ç…§çŒ«ç”»è™äº†ï¼Œä½†è¿˜æ˜¯æœ‰ç‚¹æ‡µã€‚ä¸ºäº†ä¸å†æ‡µåœˆï¼Œæ¥ä¸‹æ¥ï¼Œæ˜¯æ—¶å€™å¥½å¥½ç ”ç©¶ç ”ç©¶k8sçš„æ¶æ„å’Œåº•å±‚å®ç°äº†ã€‚ä¸‹æ¬¡è§ï¼ï¼ï¼\n","wordCount":"116","inLanguage":"en","image":"https://solaim.github.io/img/favicon.webp","datePublished":"2019-11-18T21:23:35+08:00","dateModified":"2019-11-18T21:23:35+08:00","author":{"@type":"Person","name":"Jerry Wang"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://solaim.github.io/posts/k8s-yaml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/"},"publisher":{"@type":"Organization","name":"Jerry Wang","logo":{"@type":"ImageObject","url":"https://solaim.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://solaim.github.io/ accesskey=h title="é¦–é¡µ (Alt + H)"><img src=https://solaim.github.io/apple-touch-icon.png alt aria-label=logo height=35>é¦–é¡µ</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://solaim.github.io/categories/ title=ğŸ•¸åˆ†ç±»><span>ğŸ•¸åˆ†ç±»</span></a></li><li><a href=https://solaim.github.io/tags/ title=ğŸšæ ‡ç­¾><span>ğŸšæ ‡ç­¾</span></a></li><li><a href=https://solaim.github.io/about/ title=ğŸŒå…³äº><span>ğŸŒå…³äº</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://solaim.github.io/>Home</a>&nbsp;Â»&nbsp;<a href=https://solaim.github.io/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">K8s Yamlé…ç½®æ–‡ä»¶</h1><div class=post-meta><span title='2019-11-18 21:23:35 +0800 +0800'>2019-11-18</span>&nbsp;Â·&nbsp;Jerry Wang</div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#1redis-deploymentéƒ¨ç½²ç¤ºä¾‹yaml>1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml</a></li><li><a href=#2apiversionæ¨¡å—>2ã€apiVersionæ¨¡å—</a></li><li><a href=#3kindæ¨¡å—>3ã€kindæ¨¡å—</a></li><li><a href=#4metadataæ¨¡å—>4ã€metadataæ¨¡å—</a></li><li><a href=#5specæ¨¡å—>5ã€specæ¨¡å—</a></li></ul></nav></div></details></div><div class=post-content><h2 id=1redis-deploymentéƒ¨ç½²ç¤ºä¾‹yaml>1ã€Redis Deploymentéƒ¨ç½²ç¤ºä¾‹yaml<a hidden class=anchor aria-hidden=true href=#1redis-deploymentéƒ¨ç½²ç¤ºä¾‹yaml>#</a></h2><p>å…ˆæ¥çœ‹ä¸€ä¸ªéƒ¨ç½²yamlç¤ºä¾‹æ–‡ä»¶ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=c># application/guestbook/redis-master-deployment.yaml </span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>apps/v1</span><span class=w> </span><span class=c># for versions before 1.9.0 use apps/v1beta2</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>Deployment</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>redis-master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>selector</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>matchLabels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>tier</span><span class=p>:</span><span class=w> </span><span class=l>backend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class=m>1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>template</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>labels</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>app</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>role</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>tier</span><span class=p>:</span><span class=w> </span><span class=l>backend</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>containers</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>master</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>image: redis  # or just image</span><span class=p>:</span><span class=w> </span><span class=l>redis</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>          </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>cpu</span><span class=p>:</span><span class=w> </span><span class=l>100m</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>            </span><span class=nt>memory</span><span class=p>:</span><span class=w> </span><span class=l>100Mi</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span><span class=nt>ports</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>        </span>- <span class=nt>containerPort</span><span class=p>:</span><span class=w> </span><span class=m>6379</span><span class=w>
</span></span></span></code></pre></div><p>é€šè¿‡æ‰§è¡Œå‘½ä»¤<code>kubectl create -f redis-master-deployment.yaml</code>ï¼Œå¯ä»¥åˆ›å»º1ä¸ªRedis master Podã€‚å¦‚æœæˆ‘æƒ³é€šè¿‡yamlæ–‡ä»¶åˆ›å»º3ä¸ªPodï¼Œæ€ä¹ˆåŠï¼Ÿ</p><p>å¾ˆç®€å•ï¼Œåªéœ€è¦å°†yamlæ–‡ä»¶ä¸­çš„spec.replicasè®¾ç½®ä¸º3å³å¯ï¼Œé‚£ä¹ˆä¸€ä¸ªyamlæ–‡ä»¶å¯ä»¥æ§åˆ¶ä»€ä¹ˆå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬é€šè¿‡å››ä¸ªæ¨¡å—ç®€å•çš„ä»‹ç»ä¸€ä¸‹k8sä½¿ç”¨çš„yamlé…ç½®æ–‡ä»¶ï¼Œå½“ç„¶äº†ä¹Ÿå¯ä»¥ä½¿ç”¨jsonæ ¼å¼ï¼Œæ¯•ç«Ÿkubectlæ˜¯æŠŠyamlæ–‡ä»¶è½¬æ¢æˆjsonæ–‡ä»¶ä¹‹åå†å‘é€ç»™kube-apiServerçš„ã€‚</p><h2 id=2apiversionæ¨¡å—>2ã€apiVersionæ¨¡å—<a hidden class=anchor aria-hidden=true href=#2apiversionæ¨¡å—>#</a></h2><p>ä¸ºå•¥è¦åœ¨è¿™å¼•å…¥ä¸€ä¸ªapiVersionï¼ŸapiVersionè·Ÿè½¯ä»¶ç‰ˆæœ¬æœ‰æ²¡æœ‰å…³ç³»ï¼Ÿ&mldr;</p><p>ä¸€ä¸ªç®€å•çš„å‘½ä»¤ï¼Œèƒ½å¤Ÿå¼•å‡ºå¾ˆå¤šé—®é¢˜ï¼Œä½†æ˜¯å›ç­”é—®é¢˜ï¼Œéœ€è¦ä¸€ä¸ªä¸€ä¸ªæ¥ã€‚</p><p>é¦–å…ˆï¼Œk8sæ˜¯master-nodeæ¶æ„æ¨¡å¼ï¼Œmasterä¸Šä¸€èˆ¬ä¸è¿è¡Œkubeletï¼ˆè¦æ˜¯æœºå™¨ç‰›é€¼ä¹Ÿå¯ä»¥çš„å“ˆï¼‰ï¼Œåªè´Ÿè´£èµ„æºçš„ç®¡ç†å’Œè°ƒåº¦ç­‰ç­‰å·¥ä½œã€‚æˆ‘ä»¬ä½¿ç”¨kubectlçš„æ—¶å€™ï¼Œå®é™…æ˜¯åœ¨è·ŸmasterèŠ‚ç‚¹ä¸Šçš„kube-apiServerè¿›è¡Œé€šä¿¡ï¼Œæ‰€æœ‰çš„è¯·æ±‚æäº¤åˆ°kube-apiServerï¼Œè€Œkubectlè·Ÿkube-apiServerçš„é€šä¿¡å®é™…ä¸Šæ˜¯ä¸€æ¬¡httpè¯·æ±‚ï¼Œæˆ‘ä»¬ä½¿ç”¨curlå‘½ä»¤å¯ä»¥è¿›è¡Œç®€å•çš„æµ‹è¯•å°±å¯ä»¥è¯å®è¿™ä¸€ç‚¹ã€‚</p><p>å…¶æ¬¡ï¼Œk8sæ•´ä½“ç‰ˆæœ¬å·²ç»å‡çº§åˆ°1.16ï¼Œç‰ˆæœ¬å‡çº§å¸¦æ¥å¯ä»¥æ“æ§èµ„æºçš„å˜åŠ¨ï¼Œå¼€å‘è€…æœŸå¾…å¢åŠ æ–°çš„èµ„æºï¼Œä»¥é¢å¯¹ä¸åŒåœºæ™¯çš„éœ€æ±‚ï¼Œä½†æ˜¯å·²ç»å­˜åœ¨çš„å®¢æˆ·ç«¯æ€ä¹ˆåŠäº†ï¼Œæ­¦æ–­çš„ç›´æ¥å‡çº§ï¼Œä¼šç ´åå…¼å®¹æ€§ï¼Œæ‰€ä»¥ï¼Œå¼•å…¥apiVersionå¯ä»¥ä¿è¯å…¼å®¹æ€§ã€‚</p><p>æ‰€ä»¥ä½¿ç”¨apiVersionæ—¢å¯ä»¥ä¿è¯å…¼å®¹æ€§ï¼Œåˆå¯ä»¥å…¼é¡¾å®ç°å±‚é¢çš„é—®é¢˜ã€‚Soï¼Œnext oneï¼</p><p>apiVersionè·Ÿè½¯ä»¶çš„Versionæ˜¯æ²¡æœ‰ç›´æ¥å…³ç³»çš„ï¼ŒapiVersionå¯èƒ½å­˜åœ¨å¥½å‡ ä¸ªç‰ˆæœ¬ä¸­ã€‚ä¸åŒçº§åˆ«çš„apiVersionï¼Œæ„å‘³ç€ä¸åŒçš„ç¨³å®šæ€§å’Œæ”¯æŒåº¦ã€‚apiVersionçš„çº§åˆ«å¦‚ä¸‹ï¼š</p><table><thead><tr><th style=text-align:center>åºå·</th><th style=text-align:center>ç‰ˆæœ¬</th><th style=text-align:center>å¤‡æ³¨</th></tr></thead><tbody><tr><td style=text-align:center>1</td><td style=text-align:center>alpha</td><td style=text-align:center>åç§°ä¸­åŒ…å«alphaï¼Œå¯èƒ½å­˜åœ¨bugï¼Œç‰ˆæœ¬ç‰¹æ€§å¯èƒ½è¢«ä¸¢å¼ƒï¼Œåç»­ç‰ˆæœ¬å¯èƒ½ä¸å…¼å®¹ï¼Œæµ‹è¯•ç¯å¢ƒä½¿ç”¨</td></tr><tr><td style=text-align:center>2</td><td style=text-align:center>beta</td><td style=text-align:center>åç§°ä¸­åŒ…å«betaï¼Œä»£ç ç»è¿‡æµ‹è¯•ï¼Œç‰ˆæœ¬ç‰¹æ€§ä¸ä¼šä¸¢å¼ƒï¼Œå®ç°å±‚é¢å¯èƒ½å˜åŠ¨ï¼Œéå•†ä¸šç¯å¢ƒä½¿ç”¨</td></tr><tr><td style=text-align:center>3</td><td style=text-align:center>stable</td><td style=text-align:center>åç§°ä¸­åŒ…å«vXï¼ŒXæ˜¯ä¸€ä¸ªæ•´æ•°</td></tr></tbody></table><p>ä¸ºäº†æ‰©å±•k8s apiæ–¹ä¾¿ï¼Œå¼€å‘äººå‘˜å®ç°äº†API groupsã€‚API groupsåœ¨restè·¯å¾„ä¸­æŒ‡å®šï¼Œè€Œåœ¨apiVersionä¸­æ˜¯ä¸€ä¸ªåºåˆ—åŒ–çš„å¯¹è±¡ã€‚ç›®å‰ä½¿ç”¨çš„API groupsåŒ…å«ï¼š</p><p>1ã€æ ¸å¿ƒç»„ï¼šrestè·¯å¾„æ˜¯/api/v1ï¼ŒapiVersionä¸­æ˜¯v1</p><p>2ã€å‘½åç»„ï¼šrestè·¯å¾„æ˜¯/apis/$GROUP_NAME/$VERSION,apiVersionä¸­æ˜¯$GROUP_NAME/$VERSION</p><p>æœ‰è€é“å¯èƒ½å‘ç°äº†ï¼Œä½ è¿™ç¤ºä¾‹ç»™çš„apps/v1,appsæ˜¯å•¥äº†ï¼Ÿappså°±æ˜¯ä¸€ä¸ªå‘½åç»„çš„åç§°ï¼Œè¡¨ç¤ºåŠŸèƒ½å’Œk8sè¿è¡Œçš„åº”ç”¨æœ‰å…³è”ï¼Œæ¯”å¦‚è¯´Deployments, RollingUpdates, and ReplicaSetsã€‚å½“ç„¶åŒä¸€ä¸ªè·¯å¾„ä¸‹å¯èƒ½åŒ…å«å¤šç§ç±»å‹çš„èµ„æºï¼Œæ‰€ä»¥k8sä¸ºäº†åŒºåˆ«å…·ä½“çš„åŒºåˆ«ï¼Œä½¿ç”¨äº†kindæ ‡è¯†å…·ä½“çš„èµ„æºç±»å‹ã€‚</p><h2 id=3kindæ¨¡å—>3ã€kindæ¨¡å—<a hidden class=anchor aria-hidden=true href=#3kindæ¨¡å—>#</a></h2><p>kindå­—æ®µç”¨äºæ ‡è¯†èµ„æºç±»å‹ï¼Œé‚£ä¹ˆk8sæ”¯æŒçš„èµ„æºç±»å‹æœ‰å“ªäº›äº†ï¼Ÿ</p><p>å¤ªå¤šäº†ï¼Œä¸ä¸€ä¸€åˆ—ä¸¾äº†ã€‚æå‡ ä¸ªå¸¸ç”¨çš„ï¼Œæ¯”å¦‚Deploymentã€ReplicaControllerã€Podå’ŒServiceç­‰ç­‰ã€‚ç°åœ¨æˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ï¼Œæˆ‘ä»¬æƒ³ç»™å¥¹ä¸€ä¸ªåå­—ï¼Œæ€ä¹ˆåŠï¼Ÿ</p><h2 id=4metadataæ¨¡å—>4ã€metadataæ¨¡å—<a hidden class=anchor aria-hidden=true href=#4metadataæ¨¡å—>#</a></h2><p>æ˜¾ç¤ºï¼Œmetadataæ¨¡å—å¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„è¿™ä¸ªéœ€æ±‚ï¼Œmetadata.nameå°±æ˜¯æè¿°æˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„å¯¹è±¡çš„åç§°ï¼Œå½“ç„¶k8sè¿˜æœ‰å…¶ä»–çš„metadataéœ€è¦æè¿°ï¼Œæ¯”å¦‚metadata.namespaceï¼Œé»˜è®¤ä¸ºdefaultï¼Œmetadata.uidä¸éœ€è¦æ‰‹åŠ¨å¡«å†™ï¼Œç³»ç»Ÿè‡ªåŠ¨ç”Ÿæˆã€‚è¿™å‡ ä¸ªè¦ä¹ˆå¿…é¡»å¡«å†™ï¼Œè¦ä¹ˆç³»ç»Ÿç”Ÿæˆï¼Œæ˜¯å¿…å¤‡ç¡¬è´§ã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ç»„ç»‡èµ„æºï¼Œmetadataæä¾›labelså­—æ®µï¼Œå¯ä»¥ç»„ç»‡å’Œåˆ†ç±»å¯¹è±¡ã€‚labelæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ï¼Œlabelså¯ä»¥åŒæ—¶åˆå¤šä¸ªlabelï¼Œé€—å·åˆ†éš”ã€‚è¿˜æœ‰å…¶ä»–å­—æ®µï¼Œå°±ä¸ç»†è¯´äº†ã€‚</p><p>å¥½ï¼Œä¸Šé¢ä¸‰ä¸ªæ¨¡å—åŸºæœ¬æè¿°äº†æˆ‘è¦åˆ›å»ºä¸€ä¸ªä»€ä¹ˆæ ·çš„å¯¹è±¡ï¼Œé‚£å…·ä½“å’‹å®ç°äº†ï¼Ÿå‡è®¾æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ—¶é—´ç‚¹ï¼Œå½“å‰æ—¶é—´å’Œæœ€ç»ˆæ—¶é—´ã€‚æˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ¨¡å—å»æè¿°æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ï¼Œè¿™å°±æ˜¯specæ¨¡å—çš„æ´»ã€‚</p><h2 id=5specæ¨¡å—>5ã€specæ¨¡å—<a hidden class=anchor aria-hidden=true href=#5specæ¨¡å—>#</a></h2><p>é¢ï¼Œè¿™ä¸ªæ¨¡å—å°±æ˜¯å¹²è„æ´»ã€ç´¯æ´»çš„ã€‚</p><p>åˆ›å»ºçš„å¯¹è±¡ç‰›ä¸ç‰›é€¼ï¼Œå°±çœ‹åœ¨è¿™å’‹å†™äº†ã€‚</p><p>æ—¢ç„¶specæ˜¯å†™æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·æè¿°ï¼šæˆ‘æƒ³è¦3ä¸ªé»„è‰²çš„ã€æ ‡å‡†å¤§å°çš„çº¢åŒå–œä¹’ä¹“çƒã€‚è¿™é‡Œä¹’ä¹“çƒæˆ‘ä»¬è¦çº¢åŒå–œçš„ï¼Œæ•°é‡æ˜¯ä¸‰ä¸ªï¼Œæ€§è´¨æ˜¯é»„è‰²çš„ã€æ ‡å‡†å¤§å°çš„ã€‚æ‰€ä»¥spec.selectorå°±æ˜¯é€‰æ‹©å“ªä¸ªç‰Œå­çš„ä¹’ä¹“çƒï¼Œspec.replicasæ˜¯ä¹’ä¹“çƒçš„æ•°é‡ï¼Œspec.templateåˆ™æè¿°ä¹’ä¹“çƒçš„å…·ä½“å±æ€§ä¿¡æ¯ã€‚çœ‹æ¥templateè¿˜æ˜¯å®ç°æœ€ç»ˆçŠ¶æ€çš„å…³é”®ï¼Œæ¨¡æ¿templateå°±æ˜¯ç”¨æ¥åˆ¶ä½œçº¢åŒå–œé»„è‰²ã€æ ‡å‡†å¤§å°ä¹’ä¹“çƒçš„ã€‚æ¯ä¸ªè¢«åˆ¶é€ çš„ä¹’ä¹“çƒéƒ½å…·æœ‰ç›¸åŒçš„å…ƒä¿¡æ¯ã€åˆ¶ä½œè¿‡ç¨‹å’ŒåŠŸèƒ½ï¼Œk8sç”¨spec.template.metadataæè¿°å…ƒä¿¡æ¯ï¼Œspec.template.specæè¿°åˆ¶ä½œè¿‡ç¨‹ã€‚åœ¨k8sçš„åº•å±‚ä½¿ç”¨çš„æ˜¯å®¹å™¨æŠ€æœ¯ï¼Œæ‰€ä»¥spec.template.specå®é™…æè¿°æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå®¹å™¨ï¼Œå¦‚æœkindæ˜¯Serviceï¼Œæ˜¯æ²¡æœ‰spec.template.specå­—æ®µçš„ã€‚å½“ç„¶ï¼Œspecä¸‹é¢è¿˜æœ‰å…¶ä»–å­—æ®µï¼Œéœ€è¦æ ¹æ®apiVersionå’Œkindè¿›è¡Œé€‚é…ï¼Œè¿™é‡Œå°±ä¸ç»†è¯´äº†ã€‚</p><p>æ‰€ä»¥ï¼Œyamlæ–‡ä»¶æè¿°äº†å¦‚ä½•åˆ›å»ºä¸€ä¸ªèµ„æºå¯¹è±¡ã€‚apiVersionæŒ‡å®šäº†åˆ›å»ºèµ„æºå¯¹è±¡ä½¿ç”¨çš„k8s APIç‰ˆæœ¬ï¼ŒkindæŒ‡å®šäº†ç±»å‹ï¼Œmetadataå”¯ä¸€çš„æè¿°äº†èµ„æºå¯¹è±¡ï¼Œspecæè¿°äº†æœ€ç»ˆæ—¶é—´ç‚¹èµ„æºå¯¹è±¡çš„çŠ¶æ€ã€‚</p><p>å—¯ï¼Œçœ‹å®Œè¿™ä¸ªï¼Œæ˜¯å¯ä»¥ç…§çŒ«ç”»è™äº†ï¼Œä½†è¿˜æ˜¯æœ‰ç‚¹æ‡µã€‚ä¸ºäº†ä¸å†æ‡µåœˆï¼Œæ¥ä¸‹æ¥ï¼Œæ˜¯æ—¶å€™å¥½å¥½ç ”ç©¶ç ”ç©¶k8sçš„æ¶æ„å’Œåº•å±‚å®ç°äº†ã€‚ä¸‹æ¬¡è§ï¼ï¼ï¼</p></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://solaim.github.io/posts/prometheus%E5%86%85%E9%83%A8%E5%AE%9E%E7%8E%B0%E4%B8%80/><span class=title>Â« Prev</span><br><span>Prometheuså†…éƒ¨å®ç°(ä¸€)</span>
</a><a class=next href=https://solaim.github.io/posts/k8s%E5%AE%98%E7%BD%91%E7%95%99%E8%A8%80%E6%9D%BFdemo/><span class=title>Next Â»</span><br><span>K8så®˜ç½‘ç•™è¨€æ¿demo</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://solaim.github.io/>Jerry Wang</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>